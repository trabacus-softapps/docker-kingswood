<?xml version="1.0" encoding="utf-8"?>
<openerp>
	<data>
		<!--####################################################### Search view ################################################################ -->
		
		<record id="kw_stock_search" model="ir.ui.view">
            <field name="name">stock.picking.out.search</field>
            <field name="model">stock.picking.out</field>
            <field name="arch" type="xml">
                <search string="Picking list">
                    <field name="name" string="Reference Picking List" filter_domain="['|',('name','ilike', self),('origin','ilike',self)]"/>
					<field name="state_id"/>                  
                   <field name="dest_location_id"/>
                     <!-- <field name="sup_invoice" string="Facilitator Invoiced" filter_domain="[('sup_invoice','=',True)]"/>
                     <field name="cust_invoice" attrs="{'invisible': [('type', '=', 'in')]}" string="Customer Invoiced" /> -->
                    <field name="partner_id" string="Customer" domain="[('customer','=',True)]" />
                     <!-- <field name="product" /> --> 
                    <field name="paying_agent_id" domain="[('supplier','=',True)]"/>
             		<field name="transporter"/> 
                    <field name="date_function"/>
					<field name="esugam_no"/>
                    <field name="truck_no" />
                    <field name="users"/>
                    <field name="product_id"/> 
                    <field name="state" />
                    <field name='freight_balance' string="Freight Balance"/>
                     <field name="day" invisible="1"/>
                     <field name="delivery_date_function" />
                     <field name="month" invisible="1"/>
                     <field name="year" invisible="1"/>
                     <field name="location_id" invisible="0"/>
					<field name="frtpaid_date"/>
					<field name="is_bank_submit"/>

                     <field name="sup_invoice" string="Facilitator Invoice" invisible="0"/>
		             <field name="cust_invoice" string="Customer Invoice" attrs="{'invisible': [('type', '=', 'in')]}" />
                	
                	<field name="date_from" filter_domain="[('date_function','&gt;=',self)]" string="Creation Date From"/>
                	<field name="date_to" filter_domain="[('date_function','&lt;=',self)]" string="Creation Date To"/>
                	
                	<field name="date_from" filter_domain="[('delivery_date_function','&gt;=',self)]"/>
                	<field name="date_to" filter_domain="[('delivery_date_function','&lt;=',self)]"/>
                    <filter icon="terp-check" name="draft" string="Draft" domain="[('state','=','draft')]" help="Assigned Delivery Orders"/>
                    <filter icon="terp-camera_test" name="in_transit" string="In transit" domain="[('state','=','in_transit')]" help="Confirmed Delivery Orders"/>
                    <filter icon="terp-dialog-close" name="done" string="Done" domain="[('state','=','done')]" help="Delivery orders already processed"/>
                    
					<group expand="0" string="Group By..." groups="base.group_no_one,kingswood.kw_admin_service" >
						<filter string="Location" icon="terp-folder-orange" domain="[]" context="{'group_by':'dest_location_id'}"/>
                        <filter string="Status" icon="terp-stock_effects-object-colorize" context="{'group_by':'state'}"/>
                       	<filter string="Transporter Name" icon="terp-go-month" domain="[]"  context="{'group_by':'transporter'}"/> 
                        <filter string="Customer" icon="terp-folder-orange" domain="[]" context="{'group_by':'partner_id'}"/>
                        <filter string="Product" icon="terp-folder-orange" domain="[]" context="{'group_by':'product_id'}"/>
                        <filter string="Suppliers" icon="terp-folder-orange" domain="[]" context="{'group_by':'paying_agent_id'}"/>
						<filter string="User" icon="terp-folder-orange" domain="[]" context="{'group_by':'users'}"/>
						<filter string="Truck Number" icon="terp-folder-orange" domain="[]" context="{'group_by':'truck_no'}"/>
						
						<filter string="Year" name="order_year" icon="terp-go-month" context="{'group_by':'year'}" help="Ordered yeat of the Delivery order"/>
						<filter string="Month" name="order_month" icon="terp-go-month" context="{'group_by':'month'}" help="Ordered month of the Delivery order"/>
                   		<filter string="Day" icon="terp-go-today" context="{'group_by':'day'}" help="Ordered date of the Delivery order"/>
                   		
                   		<!-- <filter string="Customer Invoiced" name="order_cust_invoice" icon="terp-stock_effects-object-colorize" context="{'group_by':'cust_invoice'}" help="Ordered yeat of the Delivery order"/>
						<filter string="Facilitator Invoiced" name="order_cust_invoice" icon="terp-stock_effects-object-colorize" context="{'group_by':'sup_invoice'}" help="Ordered month of the Delivery order"/> -->
                   		
                    </group>
                    
                    
                    
                </search>
            </field>
       </record>	
		
		
		
		
		
		<!--####################################################### TREE view ################################################################ -->
		
		<record id="kw_stock_tree" model="ir.ui.view">
            <field name="name">stock.picking.out.tree</field>
            <field name="model">stock.picking.out</field>
            <field name="arch" type="xml">
                <tree colors="blue:state == 'draft';grey:state == 'cancel';red:state not in ('cancel', 'done')" string="Delivery challan">
                    <field name="name" /> <!-- attrs="{'invisible': [('state','=','draft')]}" -->
                    <field name="partner_id" string="Customer"/>
                    <field name="product_id"/>
                	<field name="date" invisible="1"/>
                	<field name="day" string="Creation Date"/>
                	<field name="delivery_date_function"/>
                 <!--   <field name="product" invisible="1"/>-->
                    <field name="qty" string="Loaded Quantity in MTs" sum="Total"/>
                    <field name="del_quantity" sum="Total"/>
                    <field name="paying_agent_id" readonly='1'/>
                    <field name="work_order" invisible='1'/>
                    <field name='min_date' invisible='1'/>
                   <field name="location_id" invisible='1'/>
                	
                	 <field name='freight_charge'/>
                	<field name='freight_balance' string="Freight Balance" sum="Total"/> 
                    <field name="esugam_no" string="E-Sugam No."/>
                    <!-- <field name="stock_journal_id" groups="account.group_account_user"/> -->
                    <!-- <field name="driver_name" string="Transporter Name"/> -->
                    <field name="transporter" invisible="1"/>
                	<field name="truck_no"/>
                    <field name="state"/>
                    <field name="users"/>
                    <field name="stock_journal_id" invisible='1' />
                    <field name="freight" invisible="1"/>
                    <field name="day" invisible="1"/>
                     <field name="month" invisible="1"/>
                     <field name="year" invisible="1"/>
                     
                     <field name="sup_invoice" readonly="1"/>
                	<field name="cust_invoice" readonly="1"/>

					<field name="is_bank_submit" />
					<field name="frtpaid_date" />
                </tree>
            </field>
       </record>	
       
       
       <!-- ############################### Move lines Tree view ############################################################# -->
       
       <record id="kw_view_move_picking_tree" model="ir.ui.view">
            <field name="name">stock_tree</field>
            <field name="model">stock.move</field>
            <field eval="4" name="priority"/>
            <field name="arch" type="xml">
            	<tree string="Stock Moves" version="7.0" editable='top' >
            		<field name="state" invisible="1" />
		                 <field name="hide_fields" invisible="1"/>
						<field name="product_id" context="{'partner_id':parent.partner_id}"
							options='{"no_open":False}'
						on_change="onchange_product_id(product_id,location_id,location_dest_id,parent.partner_id,parent.paying_agent_id,parent.type,delivery_date)" string="Goods Details"
						/>
						<field name="partner" invisible="1"/>	
						<field name="price_unit" attrs="{'invisible':[('partner','=','ADL')]}"/>
						<field name="product_qty" string="Loaded Quantity (MT)" on_change="onchange_quantity(product_id, product_qty, product_uom, product_uos)"
							 attrs="{'readonly': [('state', '=', 'done')]}" />
						 <field name="name" invisible="1"/>
						<field name="product_uos" groups="product.group_uos" invisible="1"
						 attrs="{'readonly': [('state', '=', 'done')]}" />
						<field name="location_id" groups="base.group_no_one,kingswood.kw_admin_service,kingswood.kw_depot_service"/>
							
						<field name="location" groups="kingswood.kw_supplier_service"/>
							
						<field name="picking_id" invisible="1"/>
						<field name="create_date" invisible="1"/>
						<field name="date_expected" invisible="1"/>
						<field name="scrapped" invisible="1"/>
            		    <field name="hide_fields" invisible="1"/>
						<field name="prodlot_id" groups="stock.group_production_lot"/>
							<button
							  name="%(stock.track_line)d"
							   string="Split in Serial Number"
							   groups="stock.group_production_lot"
							   type="action" icon="gtk-justify-fill"
							   states="draft,waiting,confirmed,assigned"/>
						<field groups="stock.group_tracking_lot" name="tracking_id"/>
							    <button name="setlast_tracking" string="Put in current pack" type="object"
							      attrs="{'invisible': [('tracking_id','&lt;&gt;',False)]}"
							      icon="terp-accessories-archiver"
							      groups="stock.group_tracking_lot"
							     states="draft,assigned,confirmed"/>
							     <button name="%(stock.split_into)d" string="Put in a new pack" type="action"
							     groups="product.group_stock_packaging"
							     icon="terp-accessories-archiver+"
							       states="draft,assigned,confirmed"/>
						<field name="location_dest_id" groups="stock.group_locations" invisible="1"/>
            		<field name="delivery_date" on_change="onchange_delivey_date(delivery_date,parent.partner_id,parent.paying_agent_id,parent.type)"/>
            			<field name="cft1" attrs="{'readonly': ['|',('hide_fields', '=', False),('cft','!=',True)]}"/>
            			<field name="cft2" attrs="{'readonly': ['|',('hide_fields', '=', False),('cft','!=',True)]}"/>
            			<field name="cft" invisible='1'/>
		                <field name="unloaded_qty" string="Delivered Quantity (MT)" attrs="{'readonly': ['|',('hide_fields', '=', False),('cft','=',True)],'invisible':[('cft','=',True)]}"/>
		                <field name="rejected_qty" string="Rejected Quantity (MT)" attrs="{'readonly': [('hide_fields', '=', False)]}"/>
            			<field name="deduction_amt" attrs="{'readonly': [('hide_fields', '=', False)]}" />
						<field name="state" invisible="1"/>
						<field name='product_change' invisible="1"/> 
						<field name='partner_id' invisible="1" on_change="onchange_partner_in(partner_id)" />            
						<field name="product_uom" 
							context="{'default_product_uom':product_uom'}" 
							invisible="1"
							string="Unit of Measure" groups="product.group_uom"/>
		             </tree>
            </field>
       </record>
      
       
       <record id="kw_view_move_picking_form" model="ir.ui.view">
            <field name="name">stock_form1</field>
            <field name="model">stock.move</field>
            <field eval="100" name="priority"/>
            <field name="arch" type="xml">
          			<form string="Stock Moves" version="7.0">
						                <header>
						                   
						                	<!--<button name="%(stock.action_partial_move_server)d" string="Process Partially" type="action" states="assigned" class="oe_highlight"/>
						                    <button name="action_done" states="draft,assigned,confirmed" string="Process Entirely" type="object" class="oe_highlight"/>
						                    <button name="force_assign" states="confirmed" string="Set Available" type="object" class="oe_highlight"/>
						                    <button name="action_cancel" states="assigned,confirmed" string="Cancel Move" type="object"/>-->
						                    <field name="state" widget="statusbar" statusbar_visible="draft,confirmed,assigned,done" statusbar_colors='{"waiting":"blue","confirmed":"blue"}'/>
						                </header>
						                <sheet>
						                    <group >
						                        <group name="main_grp" string="Details">
						                        	<field name='product_change' invisible="1"/>
						                            <field name="product_id"  on_change="onchange_product_id(product_id,location_id,location_dest_id,False,False,False)" widget='selection'
						                            	/>
						                            <label for="product_qty"/>
						                            <div>
						                                <field name="product_qty"
						                                    on_change="onchange_quantity(product_id, product_qty, product_uom, product_uos)"
						                                    class="oe_inline"/>
						                                <field name="product_uom" groups="product.group_uom" class="oe_inline"/>
						                                <button name="%(stock.move_scrap)d"
						                                        string="Scrap" type="action"
						                                        icon="terp-gtk-jump-to-ltr" context="{'scrap': True}"
						                                        states="draft,waiting,confirmed,assigned" colspan="1"/>
						                            </div>
						                            <label for="product_uos_qty" groups="product.group_uos"/>
						                            <div groups="product.group_uos">
						                                <field name="product_uos_qty"
						                                    on_change="onchange_uos_quantity(product_id, product_uos_qty, product_uos, product_uom)"
						                                    class="oe_inline"/>
						                                <field name="product_uos" class="oe_inline"/>
						                                <field name="cft" invisible='1'/>
						                            </div>
						                            
						                            <field name="name"/>
						                            <field name="company_id" groups="base.group_multi_company" widget="selection"/>
						                        </group>
						                        <group name="origin_grp" string="Origin">
						                            <field name="origin"/>
						                            <field name="picking_id" domain="[('type','=',type)]"/>
						                             <field name="type" on_change="onchange_move_type(type)"/>
						                            <field name="location_id" groups="stock.group_locations" invisible="1"/>
						                           
						                            <field name='supplier_id' readonly='0'/>
						                            <field name="create_date" groups="base.group_no_one"/>
						                            
						                        </group>
						                        <group name="destination_grp" string="Destination">
						                            <field name="location_dest_id" groups="stock.group_locations"/>
						                            <field name="partner_id"  context="{'contact_display':'partner'}" groups="stock.group_locations" />
						                            <!-- <field name="addr"/>  -->
						                            <field name="date_expected" on_change="onchange_date(date,date_expected)" attrs="{'invisible': [('state', '=', 'done')]}"/>
						                            <field name="date" attrs="{'invisible': [('state', '!=', 'done')]}"/>
						                        </group>
						                        <group string="Traceability"
						                            groups="stock.group_tracking_lot">
						                            <label for="tracking_id" groups="stock.group_tracking_lot"/>
						                            <div groups="stock.group_tracking_lot">
						                                <field name="tracking_id" class="oe_inline"/><!-- on_change="onchange_product_id(product_id,location_id,location_dest_id,parent.partner_id)"  -->
						                                <button name="%(stock.split_into)d" string="New Pack" type="action"
						                                      groups="product.group_stock_packaging"
						                                      icon="terp-accessories-archiver+" 
						                                      states="draft,assigned,confirmed"/>
						                            </div>
						                            <label for="prodlot_id" groups="stock.group_production_lot"/>
						                            <div groups="stock.group_production_lot">
						                                <field name="prodlot_id"
						                                    context="{'location_id':location_id, 'product_id':product_id}"
						                                    domain="[('product_id','=',product_id)]" class="oe_inline"
						                                    on_change="onchange_lot_id(prodlot_id,product_qty, location_id, product_id, product_uom)"/>
						                                <button name="%(stock.track_line)d"
						                                    states="draft,waiting,confirmed,ass igned"
						                                    string="Split" type="action" icon="gtk-justify-fill"/>
						                            </div>
						                        </group>
						                         
						                    </group>
						                </sheet>
						                </form> 
						      </field>
						 </record>
      
      
      
      
      
      
        <!-- ############################################# Form view ###########################################################-->
		
		  <record model="ir.ui.view" id="kw_stock_form">
				<field name="name">kw.stock.form</field>
				<field name="model">stock.picking.out</field>
				<field name="type">form</field>
				<field name="arch" type="xml">
					<form string="Delivery challan" version="7.0">
						
							
            			<header>
            				<button name="deliver" states="in_transit" string="Goods Accepted" type="object" class="oe_highlight" groups="kingswood.kw_customer_service,kingswood.kw_admin_service"/>
            				<button name="%(kw_action_confirm_id)d" states="draft" string="Confirm" type="action" 
            					class="oe_highlight" groups="kingswood.kw_supplier_service,kingswood.kw_admin_service,kingswood.kw_depot_service,kingswood.kw_freight_service"/>
							<button name="%(kw_vat_action_id)d"  string="Generate Esugam" type="action" class="oe_highlight"
									attrs="{'invisible' : [('es_active','=',False),('state','!=','in_transit'),('jjform_no','!=',False)]}"/>

							<button name="send_monthly_dispatch_mail" string="Monthly Dispatch" type="object" class="oe_highlight" invisible='1'/>
            				<button name="send_daily_dispatch_mail" string="Daily Dispatch" type="object" class="oe_highlight" invisible='1'/>
            				<!-- 
            				<button name="kw_pay_freight" string="Pay Freight" type="object" class="oe_highlight" confirm="Customer Login is Suppose To Click The Pay Freight Button. If You Click Now Only One Pay Freight Voucher Will Be Created Instead Of Two.Click Ok To Continue or Login as Customer And Pay Freight"
            					groups="base.group_no_one,kingswood.kw_admin_service" attrs="{'invisible': ['|',('pay_freight', '=', False),('state','!=','done')]}"/> -->
            					
            				<button name="kw_pay_freight" string="Pay Freight " type="object" class="oe_highlight"
            					groups="base.group_no_one,kingswood.kw_freight_service"
            					attrs="{'invisible': [('state','!=','done')]}"/> 
            					
            				<button name="%(del_refund_action)d" states = "done,freight_paid" string="Refund" type="action" class="oe_highlight" groups="kingswood.kw_admin_service"/>
            				
            				<button name="action_cancel" states="draft" string="Cancel" type="object"
            					groups="kingswood.kw_admin_service" confirm="Do You Really Want To Cancel"/> 
            					
            				<button name="button_cancel" states="in_transit,done" string="Cancel" 
            					groups="kingswood.kw_admin_service" confirm="Do You Really Want To Cancel"/> 
            					<!--attrs="{'invisible':[('user_log', '!=', 'KW_Admin')]}"/>
            				<button name="all_pay_freight_button" string="All_freight" groups="base.group_no_one" type="object"/>
            				 <button name="print_report" states="in_transit" string="Print" type="object" attrs="{'invisible':[('freight','!=', False)]}"
            					class="oe_highlight" /> -->
            				
            				
            					
            				<button name="print_delivery_challan" string="Print Proforma Invoice / DC" type="object"
            					groups="base.group_no_one,kingswood.kw_admin_service,kingswood.kw_depot_service,kingswood.kw_supplier_service,kingswood.kw_customer_service"
            					class="oe_highlight" />
            				
            				<button name="print_freight_advice" type="object" string="Print Freight Advice" attrs="{'invisible': [('freight', '=', False),('gen_freight','=',False)]}"
            					groups="base.group_no_one,kingswood.kw_admin_service,kingswood.kw_depot_service,kingswood.kw_supplier_service,kingswood.kw_customer_service"
            					class="oe_highlight" />	
            				
            				<button name="print_dc_lr" type="object" string="ITC DC-LR Report"
            					attrs="{'invisible': [('report','!=',True)]}" class="oe_highlight"/>
            				        					
            					<!-- groups="base.group_no_one,kingswood.kw_admin_service,kingswood.kw_depot_service,kingswood.kw_supplier_service,kingswood.kw_customer_service"
            					 /> -->


            				
            				<!--<button name="get_del_qty" string="Update" type='object' groups="base.group_no_one"/>--> 
            				
							 	<!--<button name="draft_force_assign" states="draft" string="Confirm" type="object" class="oe_highlight" groups="base.group_user"/>
                    			<button name="draft_validate" states="draft" string="Confirm &amp; Transfer" type="object" class="oe_highlight" groups="base.group_user"/>
			                    <button name="action_assign" states="confirm" string="Check Availability" type="object" class="oe_highlight"/> 
			                    <button name="force_assign" states="confirm" string="Force Availability" type="object" class="oe_highlight" groups="base.group_user"/>
			                   -->
			                    <button name="action_process" states="assigned" string="Confirm &amp; Transfer" groups="base.group_no_one" type="object" class="oe_highlight"/>
			                    <!-- <button name="302" string="Create Invoice/Refund" attrs="{'invisible': ['|','|',('state','&lt;&gt;','confirmed'),('invoice_state','=','invoiced'),('invoice_state','=','none')]}" type="action" class="oe_highlight" groups="base.group_user"/>
			                    <button name="308" string="Reverse Transfer" states="done" type="action" groups="base.group_user"/>
			                     -->
			                     
			                <button name="%(kingswood.action_change_product_qty_wzd)d" string="Update" 
			                	attrs="{'invisible': ['|',('type', '!=', 'out'),('state','not in',('done','freight_paid','cancel'))]}"
			                	type="action" class="oe_highlight" groups="base.group_no_one,kingswood.kw_admin_service"/>
			                	
			                <button name="%(kingswood.action_change_product_qty_wzd)d" string="Update" 
			                	attrs="{'invisible': ['|',('type', '!=', 'out'),('state','not in',('in_transit'))]}"
			                	type="action" class="oe_highlight"/>			                	
			                	
			                 <button name="freight_voucher" string="Print Freight Voucher" states="freight_paid" type="object" class="oe_highlight" 
			                	groups="kingswood.kw_admin_service"/> 
            				
            				<!-- <button name="%(kingswood.action_kw_cash_voucher_wzd)d" string="Print Freight Voucher" states="freight_paid" type="action" class="oe_highlight" 
			                	groups="kingswood.kw_admin_service"/> -->
            				
            				<button name="%(kingswood.action_weighment_slip)d" string="Weightment Slip" 
            					type="action" class="oe_highlight" attrs="{'invisible':[('report','!=',True)]}" />
            				
            				<button name="open_tax_link" string="Transit Pass" type="object" class="oe_highlight"
            					attrs="{'invisible': [('transit_pass','=','False')]}"/>
            				
			                
            				<field name="state" widget="statusbar" statusbar_visible="draft,in_transit,done,freight_paid" statusbar_invisible='confirmed'/>
						</header>
               			<sheet>
		                    
							<separator string="DELIVERY CHALLAN - CUM - PROFORMA INVOICE" version="7.0"/>
						            
			          
		                    <h1>
		                        <field name="name" class="oe_inline" attrs="{'invisible': [('name','=','/')]}" readonly="1"/>
		                    </h1>
		                    <group col='6' colspan='2'>
		                        <group>
									<field name="es_active" invisible="1"/>
		                        	<field name="transit_pass" invisible="1"/>
		                        	<!-- <field name="test" invisible="0"/> -->
		                        	<field name="billing_cycle" invisible="1"/>
		                        	<field name='user_log' invisible="1" on_change="onchange_user_in(user_log)"/>
		                        	<field name='rej_quantity' invisible="1"/>
		                        	<field name='deduction_amt' invisible="1"/>	
		                        	
		                        	<field name='type' invisible="1"/>	
		                        	<field name="partner_id" on_change="onchange_partner_in(partner_id,gen_freight)"  string="Customer"  
		                        		 options='{"no_open":True,"create": true, "create_edit": true}'
		                        		 attrs="{'readonly':[('state', 'in', ('in_transit','done','balance_paid','freight_paid','cancel'))],
		                        		 		 'required':[('state', '!=', ('in_transit','done','balance_paid','freight_paid'))]}"/>
		                        		 
		                            <field name="transit_date" invisible="1"/>
		                            <field name="sup_invoice" invisible="1"/>
		                        	<field name="cust_invoice" invisible="1"/>
									<fiend name="frtpaid_date"/>
									<fiend name="is_bank_submit"/>
		                            <field name="show_esugam" invisible="1" string="related"/>
		                        	<field name="show_freight" invisible="1" string="related"/>
		                        	<field name="pay_freight" invisible="1"/>
		                        	<field name="report" invisible="1"/>
		                        	<field name="purchase_id" invisible="1"/> 	 
		                        	<field name="freight" invisible="1"/>
								 	<field name="invoice_line_id" invisible="1"/>
									
									<field name="product_id" invisible="1"/> 
									<!-- domain="[('customer','=',True)]" -->
		                        	<field name="hide_fields" invisible="1" />	
		                            <field name="backorder_id" readonly="1" attrs="{'invisible': [('backorder_id','=',False)]}"/> <!--('customer','=',True), domain="[('partner_id','in','customer_ids')]"-->
		                            <field name="invoice_state" string="Invoice Control" groups="account.group_account_invoice" attrs="{'invisible':[('invoice_state', '=', 'none')]}"/>
		                            <field name="stock_journal_id" widget="selection" groups="account.group_account_user" invisible="1"/>
		                            <field name="min_date" readonly="1" attrs="{'invisible': [('min_date','=',False)]}" invisible="1"/>
		                            <field name="gen_esugam" attrs="{'readonly':[('state', 'in', ('in_transit','done','freight_paid','cancel'))],'invisible':[('show_esugam','!=',True)]}"
		                                groups="kingswood.kw_admin_service,kingswood.kw_depot_service,kingswood.kw_supplier_service"/>
		                            <field name="esugam_no" string="E-SUGAM Number" required='1'  readonly="1"/>

									<field name="show_jjform" string="Show JJform" invisible="1"/>
		                            <field name="gen_jjform" attrs="{'readonly':[('state', 'in', ('in_transit','done','freight_paid','cancel'))],'invisible':[('show_jjform','!=',True)]}"
		                                groups="kingswood.kw_admin_service,kingswood.kw_depot_service,kingswood.kw_supplier_service"/>
		                            <field name="jjform_no" string="JJform Number" readonly="1"/>




		                            	<!-- attrs="{'readonly':[('state', 'in', ('in_transit','done','balance_paid','freight_paid','cancel'))]}"/> -->
		                        	
		                        	
		                        	
		                        	<field name="paying_agent_id" domain="[('supplier','=',True),('representative','!=',True),('handling_charges','!=',True)]" on_change="onchange_paying_agent(paying_agent_id,transporter_id)"
		                        		
		                        		groups="base.group_no_one,kingswood.kw_admin_service,kingswood.kw_depot_service,kingswood.kw_freight_service" 
		                        		attrs="{'required':['|',('user_log','=','KW_Admin'),('user_log','=','KW_Depot')],'readonly': ['|',('user_log','=','KW_Freight'),('state','not in',('draft','in_transit'))]}"/>
		                        	<!-- domain="['|','&amp;',('supplier','=',True),('supplier','!=',True),('customer','!=',True)]" -->
		                        	<field name="wc_num" invisible='1'/>
		                     		 <field name="wc_number" attrs="{'invisible':['|',('wc_num','!=',True),('state','in',('draft'))],'readonly': [('state','not in',('in_transit'))]}"/>
		                        </group>
		                        
		                        <group>
		                        	<field name="origin" placeholder="e.g. PO0032" class="oe_inline" invisible="1"/>
		                            <field name="date" string="Creation Date" readonly="1" /> <!-- attrs="{'readonly': [('state','in',('freight_paid'))]}" -->
		                            <field name="date_function" invisible="1"/>
		                            <field name="work_order"/>
		                             <field name="dc_report" invisible='1'/>
		                            <field name="state_id" 
		                            	attrs="{'required':[('user_log','=','KW_Admin')],'readonly': [('state','not in',('draft'))]}"
		                            	groups="base.group_no_one,kingswood.kw_admin_service"/>
		                            <field name="amc_attachment" invisible='1'/>
		                            <field name="filename" invisible='1'/>
		                        	<field name="fd_filename" invisible='1'/>
		                        	<field name="is_farm_decl" invisible='1'/>
		                           <field name="attachment" filename="filename" attrs="{'invisible': [('amc_attachment','!=',True)]}"/>
		                        	<field name="farmer_declaration" filename="fd_filename" attrs="{'invisible': [('is_farm_decl','!=',True)]}"/>
		                        	
		                        	<field name="gen_freight" attrs="{'readonly':[('state', 'in', ('in_transit','done','freight_paid','cancel'))],'invisible':[('show_freight','!=',True)]}"
		                        		groups="kingswood.kw_admin_service,kingswood.kw_depot_service,kingswood.kw_supplier_service"/>
		                            
								 </group>
		                    	
							 </group>
		                    <hr/>
		                    
		                    <group col='6' colspan='2'>
		                    	
		                    	<group>
		                    	    
		                    		<field name="city_id" domain = "[('state_id','=',state_id)]" required='1'
									 attrs="{'readonly':[('state', 'in', ('in_transit','done','balance_paid','freight_paid','cancel'))]}"
		                    		groups="kingswood.kw_admin_service,kingswood.kw_depot_service,kingswood.kw_supplier_service"/>
		                    		<field name='partner' invisible='1'/>
									<field name="driver_name" 
		                     			attrs="{'invisible': ['|',('paying_agent', '=', 'kingswood'),('partner','=','ADL')],'readonly':[('state', 'in', ('in_transit','done','balance_paid','freight_paid','cancel'))]}"/>		                     		
		                     		
		                     		<field name="diver_contact" attrs="{'invisible':[('partner','=','ADL')]}"
		                     			string="Transporter Contact" />
		                     		
		                     		<field name="truck_no" widget="upper_case"
			                     		required='1' attrs="{'readonly':[('state', 'in', ('in_transit','done','balance_paid','freight_paid','cancel'))]}"/>
		                     		
		                     		
		                     		<field name="paying_agent" 
		                     			invisible="1"/>
		                    		<field name="transporter_id" domain="[('supplier','=',True)]" on_change ="onchange_transporter_id(paying_agent_id,transporter_id)"
										attrs="{'required': [('paying_agent','=', 'kingswood')],'invisible':[('paying_agent','=','not')],'readonly':[('state','!=','draft')]}"
										
										
										groups="kingswood.kw_admin_service,kingswood.kw_depot_service"/>

										

			                     	
			                     	
			                     	
			                     	<field name="truck_id" required= '1' widget='selection'
			                     		attrs="{'readonly':[('state','in',('done','freight_paid'))]}" string="Truck Wheels"/>
			                     </group>
		                    
			                    <group>
			                    	
			                    	
			                    	<field name="freight_charge" string="Freight Rate/MT" on_change="onchange_freight_charge(freight_charge)"/>
			                        <field name="freight_total" string="Freight Total" attrs="{'invisible':[('state','not in',('done','freight_paid'))]}"/>
			                        <field name="freight_advance" string="Freight Advance"/>
									<field name="dc_company" invisible='1'/>
			                        <field name="amt_txt" invisible='1'/>
                                  	<field name="freight_deduction" string="Freight Deduction" attrs="{'invisible': [('state','in',('draft','in_transit'))]}"/>
			                    	<field name="freight_balance" string="Freight Balance" attrs="{'invisible': [('state','in',('draft','in_transit'))],'readonly':[('state','in',('freight_paid'))]}"/>
			                    	
			                    	
			                    </group>	
		                     
		                     
		                      
		                    	 	
		                     	
		                     </group>
		                    <notebook>
		                        <page string="Goods Details" >
		                            <field name="move_lines" context="{'default_partner_id':partner_id,'address_in_id': partner_id,'form_view_ref':'kingswood.kw_view_move_picking_form','tree_view_ref':'kingswood.kw_view_move_picking_tree','picking_type': 'out','paying_agent_id':paying_agent_id}"
		                            	 options="{&quot;reload_on_button&quot;: true}" attrs="{'readonly':['|',('state','in',('done','freight_paid','cancel')),'&amp;',('user_log', '=', 'KW_Supplier'),('state','in',('in_transit','done','freight_paid','cancel'))]}"
		                            	 />
		                             
		                            	 <!-- attrs="{'readonly': ['|',('hide_fields', '=', False),('state','in',('done','freight_paid'))]}" -->
		                            	
		                            	 
		                            	             	
                            <field name="note" placeholder="Add an internal note..." class="oe_inline"/>
                        </page>
								<page string="Bank Details">
									<group>
										<group col="4" colspan="8">
											<field name="bank_name" />
											<field name="ifsc_code" />
											<field name="ac_holder" />
											<field name="ac_number" />
											<field name="bene_code"/>
											<field name="bank_addr" />
											<field name="ac_holder_mob" />
											<field name="ac_holder_pan"/>
										</group>

										<group>

										</group>

									</group>
								</page>


                    </notebook>
                </sheet>
				<div class="oe_chatter">
					<field name="message_ids" widget="mail_thread"/>
					<field name="message_follower_ids" widget="mail_followers"/>
				</div>
				</form>
 			</field>	
		</record>
		


<!--###################################################################### Action ############################################################ -->
   
	
        
        <!-- <menuitem action="action_picking_tree" id="menu_action_picking_tree" parent="menu_stock_warehouse_mgmt" sequence="3" invisible="1"/> -->

		<record model="ir.actions.act_window" id="kw_stock_action">
            	<field name="name">Delivery Challan</field>
            	<field name="type">ir.actions.act_window</field>
            	<field name="res_model">stock.picking.out</field>
            	<field name="view_type">form</field>
				<field name="domain">[('type','=','out')]</field>
				<field name="context">{'default_type':'out','type':'out'}</field>
            	<field name="view_mode">tree,form</field>
            	<field name="search_view_id" ref="kw_stock_search"/>
			
	     </record>
	    
	   <record id="kw_stock_action_tree" model="ir.actions.act_window.view">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="kw_stock_tree"/>
            <field name="act_window_id" ref="kw_stock_action"/>
        </record>
	        
	        <record model="ir.actions.act_window.view" id="kw_stock_action_form">
	        	<field name="view_mode">form</field>
	        	<field eval="2" name="sequence"/>
	        	<field name="view_id" ref="kw_stock_form"/>
	        	<field name="act_window_id" ref="kw_stock_action"/>
	        </record>	
	     
	<menuitem action="kw_stock_action" name="Delivery Challan" id="kw_menu_action_picking_tree" parent="stock.menu_stock_warehouse_mgmt" sequence="3"
		groups="base.group_no_one,kingswood.kw_admin_service,kingswood.kw_depot_service,kingswood.kw_supplier_service"/>
	
	
	
	
	
	<!-- <record model="ir.actions.act_window" id="kw_stock_move_action">
            	<field name="name">Stock Move</field>
            	<field name="type">ir.actions.act_window</field>
            	<field name="res_model">stock.move</field>
            	<field name="view_type">form</field>
            	<field name="view_mode">tree,form</field>
            
			
	     </record>
	    
	   <record id="kw_stock_move_actiontree" model="ir.actions.act_window.view">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="kw_view_move_picking_tree"/>
            <field name="act_window_id" ref="kw_stock_move_action"/>
        </record>
	        
	        <record model="ir.actions.act_window.view" id="kw_stock_move_action_form">
	        	<field name="view_mode">form</field>
	        	<field eval="2" name="sequence"/>
	        	<field name="view_id" ref="kw_view_move_picking_form"/>
	        	<field name="act_window_id" ref="kw_stock_move_action"/>
	        </record> -->
	
	<!-- *************************************************************************Customer Search ******************************************-->
	
	<record id="kw_customer_search" model="ir.ui.view">
            <field name="name">stock.picking.out.search</field>
            <field name="model">stock.picking.out</field>
            <field name="arch" type="xml">
                <search string="Picking list">
                    <field name="name" string="Reference Picking List" filter_domain="['|',('name','ilike', self),('origin','ilike',self)]"/>
                    <field name="product" string="Product List" filter_domain="[('product','ilike', self)]"/>
                    <field name="partner_id" string="Customer" />
                    
                    <field name="paying_agent_id"/>
                    <field name="state"/>
                    <field name="date"/>
                    <field name="truck_no" />
                    <field name="work_order"/>
					<field name="esugam_no"/>
                    <!-- <field name="truck_no" /> -->
                    
                   
                    <field name="users" invisible='1'/>
                    <filter icon="terp-check" name="draft" string="Draft" domain="[('state','=','draft')]" help="Assigned Delivery Orders"/>
                    <filter icon="terp-camera_test" name="in_transit" string="In transit" domain="[('state','=','in_transit')]" help="Confirmed Delivery Orders"/>
                    <filter icon="terp-dialog-close" name="done" string="Done" domain="[('state','=','done')]" help="Delivery orders already processed"/>
					<separator/>
                    <filter icon="terp-accessories-archiver-minus" string="Back Orders" domain="[('backorder_id', '!=', False)]" help="Is a Back Order"/>
                    <separator/>
                    <filter icon="terp-dolar" name="to_invoice" string="To Invoice" domain="[('invoice_state','=','2binvoiced')]" help="Delivery orders to invoice"/>
                    <field name="partner_id" filter_domain="[('partner_id','child_of',self)]"/>
                    <field name="stock_journal_id"/>
                    <field name="company_id" groups="base.group_multi_company"/>
                    <group expand="0" string="Group By...">
                        <filter string="Status" icon="terp-stock_effects-object-colorize" domain="[]" context="{'group_by':'state'}"/>
                        <filter string="Order Date" icon="terp-go-month" domain="[]"  context="{'group_by':'date'}"/>
                       	<filter string="Transporter Name" icon="terp-go-month" domain="[]"  context="{'group_by':'transporter'}"/> 
                        <filter string="Work Order Number " icon="terp-folder-orange" domain="[]" context="{'group_by':'work_order'}"/>
                        <filter string="Customer" icon="terp-folder-orange" domain="[]" context="{'group_by':'partner_id'}"/>
                        <filter string="Product" icon="terp-folder-orange" domain="[]" context="{'group_by':'product'}"/>
                        <filter string="Suppliers" icon="terp-folder-orange" domain="[]" context="{'group_by':'paying_agent_id'}"/>
						<filter string="User" icon="terp-folder-orange" domain="[]" context="{'group_by':'users'}"/>
                    </group>
                </search>
            </field>
       </record>
       
       <!-- *************************************************************************Customer Tree ******************************************-->
       
	 <record id="kw_customer_tree" model="ir.ui.view">
            <field name="name">stock.picking.out.tree</field>
            <field name="model">stock.picking.out</field>
            <field name="arch" type="xml">
                <tree colors="blue:state == 'draft';grey:state == 'cancel';red:state not in ('cancel', 'done') and min_date &lt; current_date" string="Delivery challan">
                    <field name="name" /> <!-- attrs="{'invisible': [('state','=','draft')]}" -->
                    <field name="partner_id" string="Customer"/>
                    <field name="date"/>
                    <field name="product_id"/>
                  
                     <field name="qty" sum="Total"/>
                     <field name="paying_agent_id" invisible='1'/>
                    <field name="work_order" invisible='1'/>
                    <field name='min_date' invisible='1'/>
                    
                    <field name="transporter"/>
                	<field name="truck_no"/>
                    <field name="esugam_no" string="E-Sugam No."/>
                    <!-- <field name="stock_journal_id" groups="account.group_account_user"/> -->
                    <!-- <field name="driver_name" string="Transporter Name"/> -->
                    <field name="state"/>
                    <field name="users" invisible='1' />
                    <field name="stock_journal_id" invisible='1' />
                </tree>
            </field>
       </record> 
	
	<!-- *************************************************************************Customer Form ******************************************-->
	
	 <record model="ir.ui.view" id="kw_customer_stock_form">
				<field name="name">kw.customer.stock.form</field>
				<field name="model">stock.picking.out</field>
				<field name="type">form</field>
				<field name="arch" type="xml">
					<form string="Delivery challan" version="7.0">
            			<header>
            				<button name="%(kw_action_confirm_id)d" states="draft" string="Confirm" type="object" class="oe_highlight" groups="kingswood.kw_supplier_service,kingswood.kw_depot_service,kingswood.kw_freight_service"/>
							<button name="%(kw_vat_action_id)d"  string="Generate Esugam" type="action" class="oe_highlight"
									attrs="{'invisible' : [('es_active','=',False),('state','!=','in_transit'),('jjform_no','!=',False)]}"/>

            				<button name="deliver" states="in_transit" string="Goods Accepted" type="object" class="oe_highlight" groups="kingswood.kw_customer_service"/>
            				<button name="kw_pay_freight" states="done" string="Pay Freight" type="object" class="oe_highlight"/>
            		        <button name="%(kingswood.action_change_product_qty_wzd)d" string="Update" 
			                	attrs="{'invisible': ['|',('type', '!=', 'out'),('state','not in',('in_transit'))]}"
			                	type="action" class="oe_highlight"/>
            				<field name="state" widget="statusbar" statusbar_visible="draft,in_transit,done,freight_paid" statusbar_invisible='confirmed'/>
						</header>
               			<sheet>
		                    
							<separator string="DELIVERY CHALLAN - CUM - FREIGHT ADVICE" version="7.0"/>
						            
			          
		                    <h1>
		                        <field name="name" class="oe_inline" attrs="{'invisible': [('name','=','/')]}" readonly="1"/>
		                    </h1>
		                     <group col='6' colspan='2'>
		                        <group>
									<field name="es_active" invisible="1"/>
		                        	<field name="partner_id" options='{"no_open":True,"create": false, "create_edit": false}' on_change="onchange_partner_in(partner_id,gen_freight)" required="1" string="Customer"  domain="[('customer','=',True)]" attrs="{'readonly':[('state', 'in', ('in_transit','done','balance_paid'))]}" readonly="1"
		                        		 widget='selection'/>
		                            <field name="backorder_id" readonly="1" attrs="{'invisible': [('backorder_id','=',False)]}"/>
		                            <field name="invoice_state" string="Invoice Control" groups="account.group_account_invoice" attrs="{'invisible':[('invoice_state', '=', 'none')]}" readonly="1"/>
		                            <field name="stock_journal_id" widget="selection" groups="account.group_account_user" invisible="1" readonly="1"/>
		                            <field name="min_date" readonly="1" attrs="{'invisible': [('min_date','=',False)]}" invisible="1"/>
		                            <field name="esugam_no" string="E-SUGAM Number" readonly="1"/>
									<field name="wc_num" invisible='1'/>
		                     		<field name="wc_number" attrs="{'invisible':['|',('wc_num','!=',True),('state','in',('draft'))],'readonly': [('state','not in',('in_transit'))]}"/>		                             
		                            <field name="jjform_no" string="JJform Number" readonly="1"/>

		                        	   	   	   	<!-- <field name="paying_agent_id"
		                        		groups="kingswood.kw_admin_service,kingswood.kw_depot_service"/> -->
		                        </group>
		                        
		                        <group>
		                        	<field name="origin" placeholder="e.g. PO0032" class="oe_inline" invisible="1"/>
		                            <field name="date" string="Creation Date" readonly='1' />
		                            <field name="work_order" readonly="1"/> 
		                            <field name="pay_freight" invisible="1"/> 
		                            <field name="report" invisible="1"/>  <field name="type" invisible="1"/> 
		                            <!-- <field name="wc_number" attrs="{'invisible':[('report','!=','True')],'required':[('report','=','True')],'readonly': [('state','not in',('in_transit'))]}"/> -->
		                           <field name="billing_cycle" invisible="1"/> 
		                            <field name="amc_attachment" invisible='1'/>
		                        	<field name="is_farm_decl" invisible='1'/>
		                             <field name="filename" invisible='1'/>
		                        	<field name="fd_filename" invisible='1'/>
		                            <field name="attachment" filename="filename" attrs="{'invisible': [('amc_attachment','!=',True)]}"/>
		                        	<field name="farmer_declaration" filename="fd_filename" attrs="{'invisible': [('is_farm_decl','!=',True)]}"/>
								 </group>
		                    	
							 </group>
		                    <hr/>
		                    
		                    <group col='6' colspan='2'>
		                    	
		                    	<group>
		                    		<field name="paying_agent" invisible="1"/>
		                    		<field name="city_id" attrs="{'readonly': [('state','not in',('draft'))]}"/>
		                     		<!-- <field name="driver_name" readonly="1"
		                     			attrs="{'invisible': [('paying_agent', '=', 'kingswood')]}"/>
		                     			/>
		                    		<field name="transporter_id" groups="kingswood.kw_customer_service" readonly="1"
		                    			attrs="{'invisible':[('paying_agent','!=','kingswood')]}"/>  -->
		                    		<field name="transporter_id" domain="[('supplier','=',True)]" 
										readonly="1"
										attrs="{'required': [('paying_agent','=', 'kingswood')],'invisible':[('paying_agent','=','not')]}"
										
										
										groups="kingswood.kw_admin_service,kingswood.kw_depot_service"/>
										
									<field name="driver_name" readonly="1"
		                     			attrs="{'invisible': [('paying_agent', '=', 'kingswood')]}"/>
			                     	<field name="truck_no" readonly="1"/>
			                     	
			                     	<field name="diver_contact" string="Transporter Contact" readonly="1"/>
			                     </group>
		                    
			                    <group >
			                    	
			                    	
			                        <field name="freight_charge" string="Freight Rate/MT"/>
			                    	<field name="freight_total" string="Freight Total" 
			                    		attrs="{'invisible':[('state','not in',('done','freight_paid'))]}"/>
			                        <field name="freight_advance" readonly="1"/>
	
			                        <!-- <field name="driver_name" string="Transporter Name"/> -->
			                        
			                    	<field name="freight_deduction" string="Freight Deduction" attrs="{'invisible': [('state','in',('draft','in_transit'))]}"/>
			                    	<field name="freight_balance" string="Freight Balance" attrs="{'invisible': [('state','in',('draft','in_transit'))],'readonly': [('state','in',('freight_paid'))]}"/>
			                    	
			                    </group>
			                   </group>	
		                    <notebook>
		                        <page string="Goods Details">
		                            <field name="move_lines" context="{'default_partner_id':partner_id,'address_in_id': partner_id, 'picking_type': 'out'}"
		                            	 options="{&quot;reload_on_button&quot;: true}">
		                            	 <tree string="Stock Moves" version="7.0" editable='top'>
		                            	 	<field name="hide_fields" invisible="1"/>
		                            	 	<field name="product_change" invisible="1"/>
							        			<field name="product_id" context="{'partner_id':parent.partner_id}" string="Goods Details" 
							        				widget='selection' attrs="{'readonly': [('hide_fields', '=', True),('product_change', '=', False)]}"
							        				on_change="onchange_product_id(product_id,location_id,location_dest_id,parent.partner_id,False,False,delivery_date)" />
							        			<field name="origin" invisible="1"/>	
							        			<field name="partner" invisible="1"/>	
							        			<field name="price_unit" attrs="{'invisible':[('partner','=','ADL')],'readonly': [('hide_fields', '=', True),('product_change', '=', False)]}" />
							                    <field name="product_qty" string="Loaded Quantity (MT)" on_change="onchange_quantity(product_id, product_qty, product_uom, product_uos)" 
							                    	attrs="{'readonly': [('hide_fields', '=', True),('product_change', '=', False)]}"/>
							                   
							                    <field name="name" invisible="1"/>
							                    <field name="product_uos" groups="product.group_uos" invisible="1"/>
							                    <field name="location_id" groups="stock.group_locations" invisible="1"/>
							                    <field name="picking_id" invisible="1" />
							                    <field name="create_date" invisible="1" />
							                    <field name="date_expected" invisible="1" />
							                    
							                    <field name="scrapped" invisible="1"/>
							                    <field name="prodlot_id" groups="stock.group_production_lot"/>
							                    <button
							                       name="%(stock.track_line)d"
							                       string="Split in Serial Number"
							                       groups="stock.group_production_lot"
							                       type="action" icon="gtk-justify-fill"
							                       states="draft,waiting,confirmed,assigned"/>
							                     <field groups="stock.group_tracking_lot" name="tracking_id"/>
							                     <button name="setlast_tracking" string="Put in current pack" type="object"
							                        attrs="{'invisible': [('tracking_id','&lt;&gt;',False)]}"
							                        icon="terp-accessories-archiver"
							                        groups="stock.group_tracking_lot"
							                        states="draft,assigned,confirmed"/>
							                     <button name="%(stock.split_into)d" string="Put in a new pack" type="action"
							                        groups="product.group_stock_packaging"
							                        icon="terp-accessories-archiver+"
							                        states="draft,assigned,confirmed"/>
							                      
							                 <field name="location_dest_id" groups="stock.group_locations" invisible="1"/>
            								<field name="delivery_date"/>
					            			<field name="cft1" attrs="{'readonly': ['|',('hide_fields', '=', False),('cft','!=',True)]}"/>
					            			<field name="cft2" attrs="{'readonly': ['|',('hide_fields', '=', False),('cft','!=',True)]}"/>
					            			<field name="cft" invisible='1'/>		                            	 		
		                            	 		
		                            	 	<field name="unloaded_qty" string="Delivered Quantity (MT)" attrs="{'readonly': ['|',('state', 'in', ('done')),('cft','=',True)]}"/>

		                            	 		<field name="rejected_qty" string="Rejected Quantity (MT)"
														attrs="{'readonly': [('state', 'in', ('done'))]}"/>

		                            	 	   <field name="deduction_amt" attrs="{'readonly': [('state', 'in', ('done'))]}"/>
							                      <field name="state" invisible="1"/>

							                      <field name="product_uom" context="{'default_product_uom':product_uom'}" string="Unit of Measure" groups="product.group_uom" readonly="1"/>
		               					 </tree>
               					 
<!-- ********************************************* one to many form ******************************************************-->


						              <form string="Stock Moves" version="7.0">
						                <header>
						                   
						                	
						                    <field name="state" widget="statusbar" statusbar_visible="draft,confirmed,assigned,done" statusbar_colors='{"waiting":"blue","confirmed":"blue"}'/>
						                </header>
						                <sheet>
						                    <group>
						                        <group name="main_grp" string="Details">
						                            <field name="product_id"/>
						                            <label for="product_qty"/>
						                            <div>
						                                <field name="product_qty"
						                                    on_change="onchange_quantity(product_id, product_qty, product_uom, product_uos)"
						                                    class="oe_inline"/>
						                                <field name="product_uom" groups="product.group_uom" class="oe_inline"/>
						                                <button name="%(stock.move_scrap)d"
						                                        string="Scrap" type="action"
						                                        icon="terp-gtk-jump-to-ltr" context="{'scrap': True}"
						                                        states="draft,waiting,confirmed,assigned" colspan="1"/>
						                            </div>
						                            <label for="product_uos_qty" groups="product.group_uos"/>
						                            <div groups="product.group_uos">
						                                <field name="product_uos_qty"
						                                    on_change="onchange_uos_quantity(product_id, product_uos_qty, product_uos, product_uom)"
						                                    class="oe_inline"/>
						                                <field name="product_uos" class="oe_inline"/>
						                            </div>
						                            <field name="name"/>
						                            <field name="company_id" groups="base.group_multi_company" widget="selection"/>
						                        </group>
						                        <group name="origin_grp" string="Origin">
						                            <field name="origin"/>
						                            <field name="picking_id" domain="[('type','=',type)]"/>
						                             <field name="type" on_change="onchange_move_type(type)"/>
						                            <field name="location_id" groups="stock.group_locations"/>
						                            <field name='supplier_id' readonly='1'/>
						                            <field name="create_date" groups="base.group_no_one"/>
						                        </group>
						                        <group name="destination_grp" string="Destination">
						                            <field name="location_dest_id" groups="stock.group_locations"/>
						                            <field name="partner_id"  context="{'contact_display':'partner'}" groups="stock.group_locations" />
						                            <!-- <field name="addr"/>  -->
						                            <field name="date_expected" on_change="onchange_date(date,date_expected)" attrs="{'invisible': [('state', '=', 'done')]}"/>
						                            <field name="date" attrs="{'invisible': [('state', '!=', 'done')]}"/>
						                        </group>
						                        <group string="Traceability"
						                            groups="stock.group_tracking_lot">
						                            <label for="tracking_id" groups="stock.group_tracking_lot"/>
						                            <div groups="stock.group_tracking_lot">
						                                <field name="tracking_id" class="oe_inline"/>
						                                <button name="%(stock.split_into)d" string="New Pack" type="action"
						                                      groups="product.group_stock_packaging"
						                                      icon="terp-accessories-archiver+"
						                                      states="draft,assigned,confirmed"/>
						                            </div>
						                            <label for="prodlot_id" groups="stock.group_production_lot"/>
						                            <div groups="stock.group_production_lot">
						                                <field name="prodlot_id"
						                                    context="{'location_id':location_id, 'product_id':product_id}"
						                                    domain="[('product_id','=?',product_id)]" class="oe_inline"
						                                    on_change="onchange_lot_id(prodlot_id,product_qty, location_id, product_id, product_uom)"/>
						                                <button name="%(stock.track_line)d"
						                                    states="draft,waiting,confirmed,assigned"
						                                    string="Split" type="action" icon="gtk-justify-fill"/>
						                            </div>
						                        </group>
						                    </group>
						                </sheet>
						                </form>
               				 </field>            	
                            <field name="note" placeholder="Add an internal note..." class="oe_inline"/>
                        </page>
                       
                    </notebook>
                	</sheet>
				</form>
 			</field>	
		</record>
		
		
	<record model="ir.actions.act_window" id="kw_customer_action">
            	<field name="name">Delivery challan</field>
            	<field name="type">ir.actions.act_window</field>
            	<field name="res_model">stock.picking.out</field>
            	<field name="view_type">form</field>
				<field name="domain">[('type','=','out')]</field>
				<field name="context">{'default_type':'out', 'type':'out'}</field>
            	<field name="view_mode">tree,form</field>
            	<field name="search_view_id" ref="kw_stock_search"/>
			
	     </record>
	    
	   <record id="kw_customer_action_tree" model="ir.actions.act_window.view">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="kw_customer_tree"/>
            <field name="act_window_id" ref="kw_customer_action"/>
        </record>
	        
	        <record model="ir.actions.act_window.view" id="kw_customer_action_form">
	        	<field name="view_mode">form</field>
	        	<field eval="2" name="sequence"/>
	        	<field name="view_id" ref="kw_customer_stock_form"/>
	        	<field name="act_window_id" ref="kw_customer_action"/>
	        </record>	
	     
	<menuitem action="kw_customer_action" name="Delivery Challan" id="kw_menu_action_customer_tree" parent="stock.menu_stock_warehouse_mgmt" sequence="3"
		groups="kingswood.kw_customer_service"/>	
	
	
	
	
	
	
<!-- ******************************************* To replace all string contains "Products" by "Goods" ***************************************************-->

	<record id="kw_shipment" model="ir.ui.view">
            <field name="name">kw_shipment.stock</field>
            <field name="model">stock.move</field>
            <field name="inherit_id" ref="stock.view_move_picking_tree"/>
            
            <field name="arch" type="xml" >
            	<xpath expr="//field[@name='product_id']" position="attributes">
                    <attribute name="string">Goods Details</attribute>
 				</xpath>
 				 <xpath expr="//tree[@string='Stock Moves']" position="attributes">
                    <attribute name="editable">top</attribute>
 				</xpath>
 				<xpath expr="//field[@name='product_id']" position="after">
 					<field name="name" invisible="1"/>
 					<field name="hide_fields" invisible="1"/>
 					<field name="delivery_date" invisible="1" 
 						on_change="onchange_delivey_date(delivery_date,parent.partner_id,False,parent.type)"/>
 					<!-- <field name="location_dest_id" attrs="{'readonly': [('hide_fields', '=', False)]}"/> -->
 				</xpath>
 				<xpath expr="//field[@name='product_id']" position="replace">
                    
					<field name="product_id" on_change="onchange_product_id(product_id,location_id,location_dest_id,parent.partner_id,False,False,delivery_date)"/>
 				</xpath> 
 				<!-- <xpath expr="//field[@name='location_dest_id']" position="attributes">
                    <attribute name="attrs">{'readonly': [('hide_fields', '=', False)]}</attribute>
 				</xpath> -->
 				
 				
 				<!-- <xpath expr="//field[@name='product_qty']" position ="attributes">
 					
 					<field name="location_dest_id" invisible="0"/>
 				</xpath> -->
 				
 			</field>	
	</record>
	
	
		<record id="kw_stock_moves" model="ir.ui.view">
            <field name="name">kw_stock_moves.stock</field>
            <field name="model">stock.move</field>
            <field name="inherit_id" ref="stock.view_move_tree"/>
            
            <field name="arch" type="xml" >
            	<xpath expr="//field[@name='product_id']" position="attributes">
                    <attribute name="string">Goods Details</attribute>
 				</xpath>
 				<xpath expr="//field[@name='product_uos']" position="attributes">
                    <attribute name="string">Goods UOS</attribute>
 				</xpath>
 				
 			</field>	
	</record>
	
	
	<!-- <record id="kw_Incoming_goods" model="ir.ui.view">
            <field name="name">kw.stock</field>
            <field name="model">stock.move</field>
            <field name="inherit_id" ref="stock.view_move_form"/>
            
            <field name="arch" type="xml" >
            	<xpath expr="//field[@name='product_id']" position="attributes">
                    <attribute name="string">Goods Details</attribute>
 				</xpath>
 				
 				
 			</field>	
	</record>
	 -->
	<!-- <record id="kw_picking_out1" model="ir.ui.view">
            <field name="name">kw_picking_out.stock</field>
            <field name="model">stock.picking.out</field>
            <field name="inherit_id" ref="stock.view_picking_form"/>
            <field name="arch" type="xml" >
            	<xpath expr="//page[@string='Products']" position="attributes">
                    <attribute name="string">Goods Details</attribute>
 				</xpath>
		
            </field>
	</record> -->
	
		<record id="kw_picking_in_form_view" model="ir.ui.view">
			<field name="name">kw.picking.in.form.view</field>
			<field name="model">stock.picking.in</field>
			<field name="inherit_id" ref="stock.view_picking_in_form"/>
			<field name="arch" type="xml">
				<xpath expr="//button[@string='Confirm']" position="attributes">
					<attribute name="invisible">1</attribute>
				</xpath>
				
				<xpath expr="//notebook/page/field[@name='move_lines']" position = 'replace'>
					<field name="move_lines" context="{'address_in_id': partner_id, 'form_view_ref':'stock.view_move_picking_form', 'tree_view_ref':'stock.view_move_picking_tree', 'picking_type': 'internal'}" 
						options="{&quot;reload_on_button&quot;: true}"/>
				</xpath>
				<xpath expr="//button[@string='Return Products']" position="attributes">
					<attribute name="invisible">1</attribute>
				</xpath>

				<xpath expr="//notebook/page[@string='Additional Info']" position="after">
					<page string="Bank Details">
						<group>
							<group col="4" colspan="8">
								<field name="bank_name" />
								<field name="ifsc_code" />
								<field name="ac_holder" />
								<field name="ac_number" />
								<field name="bank_addr" />
								<field name="ac_holder_mob" />
							</group>

							<group>

							</group>

						</group>
					</page>
				</xpath>



			</field>
		</record>
		
		
		<record id="kw_view_picking_out_form2" model="ir.ui.view">
			<field name="name">kw.stock.picking.out.form</field>
			<field name="model">stock.picking</field>
			<field name="inherit_id" ref="stock.view_picking_form"/>
			<field name="arch" type="xml">
				 <xpath expr="//field[@name='partner_id']" position="after">
            		<field name='report' invisible='1'/>
            	</xpath>

				<xpath expr="//notebook/page/field[@name='move_lines']" position = "replace">
					<field name="move_lines" context="{'address_in_id': partner_id, 'form_view_ref':'stock.view_move_picking_form', 'tree_view_ref':'stock.view_move_picking_tree', 'picking_type': 'internal'}" 
						options="{&quot;reload_on_button&quot;: true}"/>
				</xpath>
			</field>
		</record>
		
		
	
	
	 <record id="kw_picking" model="ir.ui.view">
            <field name="name">kw.stock.in</field>
            <field name="model">stock.picking.in</field>
            <field name="inherit_id" ref="stock.view_picking_form"/>
            <field name="arch" type="xml" >
            
            	<xpath expr="//field[@name='partner_id']" position="attributes">
                    <attribute name="domain">[('supplier','=',True),('representative','!=',True),('handling_charges','=',False)]</attribute>
 				</xpath>
 		
            	<xpath expr="//field[@name='partner_id']" position="after">
            		<field name='truck_no' widget="upper_case" required='1'/>
            	</xpath>

            	<xpath expr="//page[@string='Products']" position="attributes">
                    <attribute name="string">Goods Details</attribute>
 				</xpath>
 					
 				<xpath expr="//field[@name='partner_id']" position="attributes">
 					<attribute name="attrs"> {'readonly': [('state','not in',('draft','assigned'))]} </attribute> 
                    <attribute name="required">1</attribute>
                    <attribute name="domain">[('supplier','=',True),('representative','!=',True),('handling_charges','=',False)]</attribute>
 				</xpath>
            	
            	<xpath expr="//field[@name='min_date']" position="attributes">
                     <attribute name="invisible">1</attribute>
                </xpath>
	             <xpath expr="//field[@name='date']" position="attributes">
                    <attribute name="attrs"> {'readonly': [('state','!=','draft')]} </attribute> 
                </xpath>
                
                 
                  
                <xpath expr="//button[@string='Cancel Transfer']" position="after">
                    <!-- <button name="get_user_qty" string="Update" type='object' groups="base.group_no_one"/>  -->
                 <button name="%(kingswood.action_change_product_qty_in)d" string="Update" 
                 				attrs="{'invisible': ['|',('type', '!=', 'in'),('state','not in',('done','freight_paid'))]}"
			                	type="action" class="oe_highlight" groups="base.group_no_one,kingswood.kw_admin_service"/>
                    <button name="kw_pay_freight" states="done" string="Pay Freight" type="object" class="oe_highlight" groups="base.group_no_one,kingswood.kw_admin_service,kingswood.kw_depot_service"/>
                </xpath>
                
         <!-- Adding Freight Balance field for incoming shipments-->
                
                <field name="origin" position="after">
                    <field name="freight_balance" attrs="{'invisible':[('state','not in', ('done','freight_paid'))],'readonly':[('state','in',('freight_paid'))]}" groups="base.group_no_one,kingswood.kw_admin_service,kingswood.kw_depot_service"/>
                </field>

 			</field>	
	</record> 
	
	
	<record id="kw_Inventories" model="ir.ui.view">
            <field name="name">kw.stock.kw_Inventories</field>
            <field name="model">stock.inventory</field>
            <field name="inherit_id" ref="stock.view_inventory_form"/>
            
            <field name="arch" type="xml" >
            	<xpath expr="//field[@name='product_id']" position="attributes">
                    <attribute name="string">Goods Details</attribute>
 				</xpath>
 				<xpath expr="//field[@name='product_uom']" position="attributes">
                    <attribute name="string">Goods Unit of Measures</attribute>
 				</xpath>
 				<xpath expr="//page[@string='Posted Inventory']/field[@name='move_ids']/tree[@string='Stock Moves']/field[@name='product_id']" position="attributes">
                    <attribute name="string">Goods Details</attribute>
 				</xpath>	
 			</field>
 			
	</record>
	
	<record id="kw_procurement" model="ir.ui.view">
            <field name="name">kw.stock.kw_procurement</field>
            <field name="model">procurement.order</field>
            <field name="inherit_id" ref="procurement.procurement_form_view"/>
            
            <field name="arch" type="xml" >
            	<xpath expr="//field[@name='product_id']" position="attributes">
                    <attribute name="string">Goods Details</attribute>
 				</xpath>
 				
 			</field>	
	</record>
	
	<record id="kw_stock_picking_in" model="ir.ui.view">
            <field name="name">kw.stock.in.form</field>
            <field name="model">stock.picking.in</field>
            <field name="inherit_id" ref="stock.view_picking_in_form"/>
            
            <field name="arch" type="xml" >
            	<xpath expr="//field[@string='Supplier']" position="attributes">
                    <attribute name="string">Paying Agent</attribute>
 				</xpath>
 				
 				<xpath expr="//field[@name='partner_id']" position="attributes">
                    <attribute name="required">1</attribute>
                    <attribute name="domain">[('supplier','=',True),('representative','!=',True),('handling_charges','=',False)]</attribute>
                </xpath>
 				
 			</field>	
	</record> 
	
	<record id="kw_stock_picking_in_search" model="ir.ui.view">
            <field name="name">kw.stock.search</field>
            <field name="model">stock.picking.in</field>
            <field name="inherit_id" ref="stock.view_picking_in_search"/>
			<field name="arch" type="xml" >
            	<xpath expr="//field[@name='product_id']" position="after">
            		  
   					<field name="location_id" string="Location"/>
                    <field name="date_function"/>
            		<field name="date_from" filter_domain="[('date','&gt;=',self)]"/>
            		<field name="date_to" filter_domain="[('date','&lt;=',self)]"/>
                    <field name="truck_no"/>
                    <!-- <field name="product"/>
                    <field name="invoice_state" groups="account.group_account_invoice"/>
                    <field name="stock_journal_id" widget="selection" groups="account.group_account_user"/>-->
                    <field name="state"/>
                    <field name="users"/>
                    <field name="day" invisible="0"/>
                     <field name="month" invisible="0"/>
                     <field name="year" invisible="0"/>
 				</xpath> 
 				 <xpath expr="//group/filter[@string='Expected Date']" position="replace">
 					<filter string="Products" icon="terp-folder-orange" domain="[]" context="{'group_by':'product_id'}"/>
 				</xpath>
 				<xpath expr="//group/filter[@string='Journal']" position="after">
 					
 					<filter string="Supplier" icon="terp-folder-orange" domain="[]" context="{'group_by':'partner_id'}"/>
 					<filter string="User" icon="terp-folder-orange" domain="[]" context="{'group_by':'users'}"/>
 					<filter string="Year" name="order_year" icon="terp-go-month" context="{'group_by':'year'}" help="Ordered yeat of the Delivery order"/>
						<filter string="Month" name="order_month" icon="terp-go-month" context="{'group_by':'month'}" help="Ordered month of the Delivery order"/>
                   		<filter string="Day" icon="terp-go-today" context="{'group_by':'day'}" help="Ordered date of the Delivery order"/>
 				</xpath>
 			</field>		
	</record> 
    
	
	 <record id="stock_picking_in_inherit_purchase" model="ir.ui.view">
            <field name="name">stock.picking.in.search.inherit</field>
            <field name="model">stock.picking.in</field>
            <field name="inherit_id" ref="purchase.stock_picking_in_inherit_purchase"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='purchase_id']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>
                <xpath expr="//field[@name='partner_id']" position="attributes">
                    <attribute name="required">1</attribute>
                </xpath>
                
            </field>
        </record> 
        
        <!-- Invoming Shipment Tree view  -->
        
        
        <record id="kw_stock_in_tree" model="ir.ui.view">
            <field name="name">stock.picking.in.tree</field>
            <field name="model">stock.picking.in</field>
             <field name="inherit_id" ref="stock.view_picking_in_tree"/>
            <field name="arch" type="xml">
            	
            	<xpath expr="//field[@name='partner_id']" position="after">
            		<field name="truck_no" string="Vehicle Number"/>
            	</xpath>
            	
            	
            	<xpath expr="//field[@name='partner_id']" position="attributes">
                     <attribute name="string">Facilitator</attribute>
                </xpath>
            	
            	<xpath expr="//field[@name='origin']" position="attributes">
                     <attribute name="invisible">1</attribute>
                </xpath>
                <xpath expr="//field[@name='backorder_id']" position="attributes">
                     <attribute name="invisible">1</attribute>
                </xpath>
                <xpath expr="//field[@name='min_date']" position="replace">
                     <field name="product_id"/>
	                  <field name="qty" sum="total"/>
	                  <field name="freight_balance" sum="total"/>
	                  <field name="date_function" invisible="1"/>
                </xpath>
                <!-- <xpath expr="//field[@name='partner_id']" position="attributes">
                     <attribute name="name">Facilitator</attribute>
                </xpath> -->
             	<xpath expr="//field[@name='invoice_state']" position="attributes">
                     <attribute name="invisible">1</attribute>
                </xpath>
                <xpath expr="//field[@name='stock_journal_id']" position="attributes">
                     <attribute name="invisible">1</attribute>
                </xpath>
              	<xpath expr="//field[@name='stock_journal_id']" position="after">
                     <field name="location_id" invisible="1"/>
                </xpath>
                <xpath expr="//field[@name='state']" position="after">
                     <field name="users" invisible="0"/>
                     <field name="day" invisible="1"/>
                     <field name="month" invisible="1"/>
                     <field name="year" invisible="1"/>
                     <field name="sup_invoice" invisible="0"/>
                </xpath>
	                
                
            </field>
       </record>
        
      

		
        
        
      <report id="stock.report_picking_list_out" model="stock.picking.out" 
      	
      	name="stock.picking.list.out" string="Delivery Challan" rml="stock/report/picking.rml" groups="base.group_system"/>
      	
      <report id="stock.report_picking_list_out" model="stock.picking.out" 
      	
      	name="stock.picking.list.out" string="Delivery Challan1" rml="stock/report/picking.rml" groups="base.group_system"/>
      	
      	
      	
      	
      	
      	<record id="kw_stock_partial_picking_form" model="ir.ui.view">
            <field name="name">stock.partial.picking.form</field>
            <field name="model">stock.partial.picking</field>
            <field name="inherit_id" ref="stock.stock_partial_picking_form"/>
            <field name="arch" type="xml">
                <!--<form string="Stock partial Picking" version="7.0">
                     <field name="hide_tracking" invisible="1"/>
                    <separator string="Transfer Products" name="product_separator"/>
                    <field name="move_ids" context="{'hide_tracking': hide_tracking}">
                        <tree editable="bottom" string="Product Moves">
                            <field name="product_id" position="attributes">
                            	<attribute name="readonly">1</attribute>
                            </field> -->
                            
                            <xpath expr="//field[@name='move_ids']/tree/field[@name='product_id']" position="attributes">
                            	<attribute name="readonly">1</attribute>
                            	
                            </xpath>
                            
                            <xpath expr="//field[@name='move_ids']/tree/field[@name='quantity']" position="attributes">
                            	<attribute name="readonly">1</attribute>
                            	
                            </xpath>
                            
                            <!-- <field name="quantity" />
                            <field name="product_uom" groups="product.group_uom"/>
                            <field name="tracking" invisible="1"/>
                            <field name="prodlot_id" domain="[('product_id', '=', product_id)]" invisible="context.get('hide_tracking',False)" attrs="{'required':[('tracking','=',True), ('quantity', '!=', 0)]}" groups="stock.group_production_lot" context="{'default_product_id':product_id}"/>
                            
                            <field name="update_cost" invisible="1"/>
                            <field name="cost"  invisible="1"/>
                            <field name="currency"  invisible="1"/> 
                        </tree>    
                       </field>
                   </form>-->
                </field>
           </record>  
	
	
<!-- *************************************************************************************      -->

  <record id="kw_view_picking_out_form" model="ir.ui.view">
            <field name="name">stock.picking.out.form</field>
            <field name="model">stock.picking.out</field>
            <field name="inherit_id" ref="kw_stock_form"/>
            <field name="arch" type="xml">
                
                <xpath expr="/form/header//button[@name='action_process']" position="replace">
                    <button name="action_process" states="assigned" string="Deliver" type="object" 
                    	groups="base.group_no_one" class="oe_highlight"/>
                </xpath>
                
            </field>
        </record>


<!-- *************************************************************************************      -->
	        <record id="kw_view_stock_form_editable_partner" model="ir.ui.view">
            <field name="name">kw.stock.form.editable</field>
            <field name="model">stock.picking.out</field>
            <field name="inherit_id" ref="kingswood.kw_stock_form"/>
            <field name="groups_id" eval="[(4, ref('kingswood.kw_supplier_service')),(4, ref('kingswood.kw_depot_service')),(4, ref('kingswood.kw_freight_service'))]"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='partner_id']" position="attributes">
                    <attribute name="options">{'create': false, 'create_edit': false,'no_open':True}</attribute>
                </xpath>
            </field>
        </record>
	
	</data>	
</openerp>
